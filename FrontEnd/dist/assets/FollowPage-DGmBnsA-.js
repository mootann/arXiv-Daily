import{d as ne,u as re,A as Q,o as ie,c as n,a as s,s as p,h as w,w as u,b as l,f as j,F as $,r as A,g as y,v as r,i as c,z as B,E as b,p as ue,t as de,k as f,l as ce,n as o,q as v,B as ve,y as q,x as _e,C as ge,D as pe,G as fe,H as he,I as ye,m as me}from"./index-DDyuordv.js";import{_ as Ce}from"./_plugin-vue_export-helper-DlAUqK2U.js";const we={class:"follow-page"},ke={key:1,class:"follow-content"},be={class:"sidebar"},De={class:"sidebar-header"},ze={class:"category-list"},xe=["onClick"],Me={class:"category-name"},Pe={key:1,class:"no-update"},Fe={key:0,class:"empty-follow"},Ve={class:"main-content"},Se={key:0,class:"paper-section"},Te={class:"section-header"},Ue={class:"header-right"},Ye={key:0,class:"date-tag"},$e={class:"paper-list"},Ae=["onClick"],Be={class:"paper-index"},Ie={class:"paper-content"},Le={class:"paper-header-row"},Ge=["innerHTML"],Ee={class:"paper-tags"},He=["href"],Ne={class:"paper-authors"},Qe={class:"paper-abstract"},je={class:"paper-footer"},qe={class:"info-item"},Ke={class:"interactions"},Re={class:"info-item"},Ze={class:"info-item"},Je={class:"info-item"},Oe={key:0,class:"pagination-container"},We={class:"manage-grid"},Xe=["onClick"],et={class:"card-header"},tt={class:"code"},at={class:"name"},st=ne({__name:"FollowPage",setup(ot){const K=me(),F=re(),D=c(!1),z=c(!1),h=c([]),m=c([]),i=c(""),x=c(!1),_=c(""),V=c(!1),g=c(1),k=c(10),S=c(0),I=de,M=Q().format("YYYY-MM-DD"),L=async()=>{if(F.isLoggedIn){D.value=!0;try{const a=await B.getFollowCategories();a.data.code===200&&(h.value=a.data.data,!i.value&&h.value.length>0?G(h.value[0]):h.value.length===0&&(i.value="",m.value=[]))}catch(a){console.error("获取关注列表失败",a),b.error("获取关注列表失败")}finally{D.value=!1}}},G=async a=>{i.value=a.category,g.value=1;const e=a.latestPaperDate||M;_.value=a.latestPaperDate||"",await P(a.category,e)},R=async()=>{if(i.value){g.value=1;const a=_.value||M;await P(i.value,a)}},P=async(a,e)=>{z.value=!0;try{const d=await ue.getPapers({page:g.value,size:k.value,category:[a],startDate:e,endDate:e,hasGithub:V.value?!0:void 0});d.data.code===200&&d.data.data.records?(m.value=d.data.data.records,S.value=d.data.data.total||0):(m.value=[],S.value=0)}catch(d){console.error("获取论文失败",d),b.error("获取论文列表失败")}finally{z.value=!1}},Z=a=>{if(k.value=a,g.value=1,i.value){const e=_.value||M;P(i.value,e)}},J=a=>{if(g.value=a,i.value){const e=_.value||M;P(i.value,e)}},T=a=>h.value.some(e=>e.category===a),O=async a=>{try{T(a)?(await B.unfollowCategory(a),b.success("已取消关注")):(await B.followCategory(a),b.success("已关注")),await L()}catch(e){console.error("操作失败",e),b.error("操作失败")}},E=a=>{const e=I.find(d=>d.value===a);return e?e.label:a},W=a=>{K.push(`/paper/${a}`)},X=a=>Q(a).format("YYYY-MM-DD"),ee=a=>Array.isArray(a)?a.join(", "):a,te=a=>a;return ie(()=>{F.isLoggedIn&&L()}),(a,e)=>{const d=f("el-button"),U=f("el-empty"),C=f("el-icon"),ae=f("el-badge"),se=f("el-switch"),H=f("el-tag"),oe=f("el-pagination"),le=f("el-dialog"),N=ce("loading");return o(),n("div",we,[e[15]||(e[15]=s("div",{class:"page-header"},[s("h2",null,"关注板块"),s("p",{class:"subtitle"},"查看您关注分类的最新论文")],-1)),p(F).isLoggedIn?(o(),n("div",ke,[s("div",be,[s("div",De,[e[10]||(e[10]=s("h3",null,"我的关注",-1)),l(d,{type:"primary",link:"",onClick:e[1]||(e[1]=t=>x.value=!0)},{default:u(()=>[l(C,null,{default:u(()=>[l(p(ve))]),_:1}),e[9]||(e[9]=v(" 管理 ",-1))]),_:1})]),j((o(),n("div",ze,[(o(!0),n($,null,A(h.value,t=>(o(),n("div",{key:t.category,class:q(["category-item",{active:i.value===t.category}]),onClick:Y=>G(t)},[s("span",Me,r(E(t.category)),1),t.paperCount&&t.paperCount>0?(o(),w(ae,{key:0,value:t.paperCount,class:"count-badge",type:"danger"},null,8,["value"])):(o(),n("span",Pe,"无更新"))],10,xe))),128)),h.value.length===0&&!D.value?(o(),n("div",Fe,[e[12]||(e[12]=s("p",null,"暂无关注分类",-1)),l(d,{type:"primary",size:"small",onClick:e[2]||(e[2]=t=>x.value=!0)},{default:u(()=>[...e[11]||(e[11]=[v("去添加",-1)])]),_:1})])):y("",!0)])),[[N,D.value]])]),s("div",Ve,[i.value?(o(),n("div",Se,[s("div",Te,[s("h3",null,r(E(i.value))+" ("+r(i.value)+") - "+r(_.value?_.value+" 更新":"暂无数据"),1),s("div",Ue,[l(se,{modelValue:V.value,"onUpdate:modelValue":e[3]||(e[3]=t=>V.value=t),"active-text":"仅显示含Github代码",onChange:R,style:{"margin-right":"15px","--el-switch-on-color":"#2563EB"}},null,8,["modelValue"]),_.value?(o(),n("span",Ye,r(_.value),1)):y("",!0)])]),j((o(),n("div",$e,[m.value.length===0&&!z.value?(o(),w(U,{key:0,description:"该分类暂无论文数据"})):y("",!0),(o(!0),n($,null,A(m.value,(t,Y)=>(o(),n("div",{key:t.arxivId,class:"paper-card",onClick:lt=>W(t.arxivId)},[s("div",Be,r(String((g.value-1)*k.value+Y+1).padStart(2,"0")),1),s("div",Ie,[s("div",Le,[s("h3",{class:"paper-title",innerHTML:te(t.title)},null,8,Ge),s("div",Ee,[l(H,{size:"small",effect:"plain"},{default:u(()=>[v(r(t.primaryCategory),1)]),_:2},1024),t.pdfUrl?(o(),w(H,{key:0,size:"small",type:"success"},{default:u(()=>[...e[13]||(e[13]=[v("PDF",-1)])]),_:1})):y("",!0),t.githubUrl?(o(),n("a",{key:1,href:t.githubUrl,target:"_blank",onClick:e[4]||(e[4]=_e(()=>{},["stop"])),class:"github-link",title:"查看代码"},[...e[14]||(e[14]=[s("svg",{height:"16","aria-hidden":"true",viewBox:"0 0 16 16",version:"1.1",width:"16","data-view-component":"true",class:"icon",fill:"currentColor"},[s("path",{d:"M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.46-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z"})],-1)])],8,He)):y("",!0)])]),s("div",Ne,r(ee(t.authors)),1),s("div",Qe,r(t.summary.length>200?t.summary.substring(0,200)+"...":t.summary),1),s("div",je,[s("span",qe,[l(C,null,{default:u(()=>[l(p(ge))]),_:1}),v(" "+r(X(t.publishedDate)),1)]),s("div",Ke,[s("span",Re,[l(C,null,{default:u(()=>[l(p(pe))]),_:1}),v(" "+r(t.viewCount||0),1)]),s("span",Ze,[l(C,null,{default:u(()=>[l(p(fe))]),_:1}),v(" "+r(t.collectCount||0),1)]),s("span",Je,[l(C,null,{default:u(()=>[l(p(he))]),_:1}),v(" "+r(t.commentCount||0),1)])])])])],8,Ae))),128))])),[[N,z.value]]),m.value.length>0?(o(),n("div",Oe,[l(oe,{"current-page":g.value,"onUpdate:currentPage":e[5]||(e[5]=t=>g.value=t),"page-size":k.value,"onUpdate:pageSize":e[6]||(e[6]=t=>k.value=t),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:S.value,onSizeChange:Z,onCurrentChange:J},null,8,["current-page","page-size","total"])])):y("",!0)])):(o(),w(U,{key:1,description:"请选择左侧分类查看论文"}))])])):(o(),w(U,{key:0,description:"请先登录以使用关注功能"},{default:u(()=>[l(d,{type:"primary",onClick:e[0]||(e[0]=t=>a.$router.push("/login"))},{default:u(()=>[...e[8]||(e[8]=[v("去登录",-1)])]),_:1})]),_:1})),l(le,{modelValue:x.value,"onUpdate:modelValue":e[7]||(e[7]=t=>x.value=t),title:"管理关注分类",width:"80%","destroy-on-close":""},{default:u(()=>[s("div",We,[(o(!0),n($,null,A(p(I),t=>(o(),n("div",{key:t.value,class:q(["manage-card",{active:T(t.value)}]),onClick:Y=>O(t.value)},[s("div",et,[s("span",tt,r(t.value),1),T(t.value)?(o(),w(C,{key:0,class:"check-icon"},{default:u(()=>[l(p(ye))]),_:1})):y("",!0)]),s("div",at,r(t.label),1)],10,Xe))),128))])]),_:1},8,["modelValue"])])}}}),it=Ce(st,[["__scopeId","data-v-7a9682cb"]]);export{it as default};
