server:
  port: 8080

spring:
  profiles:   # 启用配置文件
    active:

  datasource:
    url: jdbc:mysql://localhost:3306/arxiv_daily?useUnicode=true&characterEncoding=utf-8&useSSL=false&serverTimezone=Asia/Shanghai&allowPublicKeyRetrieval=true
    username: root
    password: 123456
    driver-class-name: com.mysql.cj.jdbc.Driver

  data:
    redis:
      host: localhost
      port: 6379
      password: 123456
      database: 0

  elasticsearch:
    uris: http://localhost:9200
    connection-timeout: 10s
    socket-timeout: 30s

  kafka:
    bootstrap-servers: localhost:9092
    # Kafka生产者配置
    producer:
      key-serializer: org.apache.kafka.common.serialization.StringSerializer
      value-serializer: org.apache.kafka.common.serialization.StringSerializer
      acks: all                                    # 消息确认机制
      retries: 3                                   # 重试次数
      batch-size: 16384                            # 批量发送大小（字节）
      buffer-memory: 33554432                      # 缓冲区大小（字节）
      compression-type: none                       # 消息压缩类型
      properties:
        request.timeout.ms: 30000                  # 请求超时时间（毫秒）
        delivery.timeout.ms: 120000                # 投递超时时间（毫秒）
        enable.idempotence: true                   # 启用幂等性
    # Kafka消费者配置
    consumer:
      group-id: arxiv-daily-group                  # 消费者组ID
      auto-offset-reset: latest                    # 没有初始偏移量时的策略
      enable-auto-commit: true                     # 启用自动提交
      auto-commit-interval: 5000                   # 自动提交间隔时间（毫秒）
      max-poll-records: 500                        # 一次拉取最大记录数
      fetch-max-wait: 500                          # 拉取间隔时间（毫秒）
      session-timeout: 30000                       # 会话超时时间（毫秒）
      heartbeat-interval: 10000                    # 心跳间隔时间（毫秒）
      key-deserializer: org.apache.kafka.common.serialization.StringDeserializer
      value-deserializer: org.apache.kafka.common.serialization.StringDeserializer
    # Kafka监听器配置
    listener:
      ack-mode: record                             # 确认模式
      concurrency: 1                               # 消费者并发数

  # ==================== Spring AI Alibaba 配置 ====================
  ai:
    chat:
      memory:
        repository:
          jdbc:
            initialize-schema: never  # 禁用自动schema初始化，使用手动创建的表
    deepseek:
      api-key: ${DEEPSEEK_API_KEY:}
      base-url: "https://api.deepseek.com/v1"
      chat:
        options:
          model: "deepseek-chat"
          top-p: 0.9
          temperature: 0.3
          max-tokens: 8192
    dashscope:
      api-key: ${QWEN_EMBEDDING_KEY:}
      chat:
        enabled: false  # 禁用 DashScope Chat，只使用 DeepSeek
      embedding:
        enabled: true
        options:
          model: text-embedding-v4
          dimensions: 2048

# ==================== MyBatis Plus 配置 ====================
mybatis-plus:
  mapper-locations: classpath*:/mapper/**/*.xml    # Mapper XML文件路径
  type-aliases-package: com.mootann.arxivdaily.repository.model  # 实体类包路径
  global-config:
    db-config:
      id-type: auto                                # 主键策略：数据库自增
      logic-delete-field: deleted                  # 逻辑删除字段（预留）
      logic-delete-value: 1
      logic-not-delete-value: 0
      table-underline: true                        # 表名下划线转驼峰
  configuration:
    map-underscore-to-camel-case: true             # 开启驼峰命名映射
    log-impl: org.apache.ibatis.logging.slf4j.Slf4jImpl  # SQL日志实现

logging:
  level:
    com.mootann.arxivdaily.repository.mapper: DEBUG  # 打印SQL日志（开发时使用）
    org.springframework.boot.autoconfigure: ERROR     # 关闭自动配置报告日志

# JWT配置
jwt:
  secret: arxiv-daily-secret-key-for-jwt-token-generation-and-validation-2026
  expiration: 86400000  # JWT过期时间（毫秒），默认24小时

# arxiv API代理配置
arxiv:
  proxy:
    enabled: true
    host: 127.0.0.1    # 代理服务器地址
    port: 7890         # 代理服务器端口

# GitHub API配置
github:
  api-base-url: https://api.github.com
  repository: mootann/arXiv-Daily       # 仓库地址
  proxy-enabled: true                   # 是否使用代理
  proxy-host: 127.0.0.1                 # 代理服务器地址
  proxy-port: 7890                      # 代理服务器端口

# MinIO对象存储配置
minio:
  endpoint: http://localhost:19000          # MinIO服务器地址
  access-key: admin                        # MinIO访问密钥
  secret-key: PaiSmart2025                 # MinIO密钥
  bucket-name: arxiv-daily                 # 默认存储桶名称
  auto-create-bucket: true                 # 是否在启动时自动创建存储桶
  connect-timeout: 10000                   # 连接超时时间（毫秒）
  write-timeout: 60000                     # 写入超时时间（毫秒）
  read-timeout: 10000                      # 读取超时时间（毫秒）
